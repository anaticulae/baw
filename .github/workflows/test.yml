name: tests

on:
  push:
    branches:
      - '*'

jobs:

  build:
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v4
    - name: build docker container
      run: make docker-build

  doctest:
    runs-on: ubuntu-latest
    needs: build

    steps:
    - uses: actions/checkout@v4
    - name: run doctest
      run: make docker-doctest

  fasttest:
    runs-on: ubuntu-latest
    needs: build

    steps:
    - uses: actions/checkout@v4
      with:
        # required by test which requires commits
        fetch-depth: 15
    - name: run fasttest
      run: make docker-fasttest

  longtest:
    runs-on: ubuntu-latest
    needs: fasttest

    steps:
    - uses: actions/checkout@v4
    - name: run longtest
      run: make docker-longtest

  linter:
    runs-on: ubuntu-latest
    needs: build

    steps:
    - uses: actions/checkout@v4
    - name: run linter
      run: make docker-lint
      continue-on-error: true
